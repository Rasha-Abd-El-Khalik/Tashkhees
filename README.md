# ğŸ©º Tashkhees  

![Python](https://img.shields.io/badge/Python-3.9%2B-blue?logo=python)  
![PyTorch](https://img.shields.io/badge/PyTorch-Framework-red?logo=pytorch)  
![Transformers](https://img.shields.io/badge/HuggingFace-Transformers-yellow?logo=huggingface)  
![MARBERT](https://img.shields.io/badge/Model-MARBERT-red)  
![LoRA](https://img.shields.io/badge/FineTuning-LoRA-green)  
![PEFT](https://img.shields.io/badge/PEFT-Enabled-purple)  
![CamelTools](https://img.shields.io/badge/CamelTools-Preprocessing-orange)  
![Gradio](https://img.shields.io/badge/UI-Gradio-orange?logo=gradio)  
![SpeechRecognition](https://img.shields.io/badge/Lib-SpeechRecognition-lightblue)  
![gTTS](https://img.shields.io/badge/Lib-gTTS-brightgreen)  
![Gemini](https://img.shields.io/badge/API-Gemini-lightblue)  

---

## ğŸš€ Overview  
**Tashkhees** is a professional **Arabic medical question classification** system.  

It integrates **deep learning + NLP preprocessing + API intelligence** in one pipeline:  
- ğŸ§  **Fine-tuned MARBERT (with LoRA & PEFT)** for domain-specific classification.  
- ğŸ§¹ **Scrubbing & advanced preprocessing**: normalization, diacritic removal, tokenization (via **CamelTools**).  
- ğŸ™ï¸ **Speech-to-text** input with `SpeechRecognition` and **text-to-speech** feedback using `gTTS`.  
- ğŸ“Š **Threshold-based hybrid decision making**:  
  - High confidence â†’ classification from fine-tuned model.  
  - Low confidence â†’ fallback to **Gemini API**.  
- ğŸ’¬ **Unified answers** always generated by Gemini, while **labels** come from the model or Gemini depending on confidence.  

---

## ğŸ“Š Dataset  
- **Source**: curated Arabic **medical Q&A website** â†’ [Altibbi](https://altibbi.com/)  
- **Classes (5 categories)**:  
  - ğŸ©¸ Ù…Ø±Ø¶ Ø§Ù„Ø³ÙƒØ±ÙŠ (Diabetes)  
  - ğŸ¥ Ø¬Ø±Ø§Ø­Ø© Ø¹Ø§Ù…Ø© (General Surgery)  
  - ğŸ¦´ Ø¬Ø±Ø§Ø­Ø© Ø§Ù„Ø¹Ø¸Ø§Ù… (Orthopedics)  
  - ğŸŒ¬ï¸ Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„ØªÙ†ÙØ³ÙŠ (Respiratory)  
  - ğŸ”¬ Ø§Ù„ØºØ¯Ø¯ Ø§Ù„ØµÙ…Ø§Ø¡ (Endocrinology)  
- **Preprocessing**:  
  - Scrubbing (cleaning noisy text, removing HTML, symbols)  
  - Normalization (Alef, Teh Marbuta, Alef Maksura)  
  - Diacritic removal  
  - Tokenization (CamelTools)  

---

## ğŸ§  Model  
- **Base model**: [MARBERT](https://huggingface.co/UBC-NLP/MARBERT)  
- **Fine-tuning**: [LoRA](https://arxiv.org/abs/2106.09685) + [PEFT](https://huggingface.co/docs/peft/index)  
- **Frameworks**: Hugging Face Transformers, PyTorch  

---

## âš™ï¸ Features  
âœ… End-to-end **speech + text pipeline**  
âœ… Arabic-specific **scrubbing & preprocessing** (CamelTools)  
âœ… Multi-class classification (**5 medical categories**)  
âœ… Hybrid decision-making with **Gemini API** fallback  
âœ… Interactive **Gradio** web interface  
âœ… Deployable on **Hugging Face Spaces**  

---

## ğŸŒ Demo  
ğŸ”— [Live Demo on Hugging Face Spaces](https://huggingface.co/spaces/rasha102004/Medical-Arabic-Speech-Classifier)  

---

## ğŸ“ˆ Results  

The fine-tuned **MARBERT + LoRA** model achieved strong performance across all 5 medical categories:  

- âœ… **Test Accuracy**: 86.6%  
- âœ… **Test F1 Score**: 86.4%  

ğŸ“Š **Classification Report**  

| Class | Description              | Precision | Recall | F1-score | Support |
|-------|--------------------------|-----------|--------|----------|---------|
| 0     | Ù…Ø±Ø¶ Ø§Ù„Ø³ÙƒØ±ÙŠ (Diabetes)    | 0.92      | 0.92   | 0.92     | 1003    |
| 1     | Ø¬Ø±Ø§Ø­Ø© Ø¹Ø§Ù…Ø© (General Surgery) | 0.90  | 0.75   | 0.82     | 1048    |
| 2     | Ø¬Ø±Ø§Ø­Ø© Ø§Ù„Ø¹Ø¸Ø§Ù… (Orthopedics) | 0.84      | 0.86   | 0.85     | 810     |
| 3     | Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„ØªÙ†ÙØ³ÙŠ (Respiratory) | 0.84 | 0.85 | 0.84 | 1017    |
| 4     | Ø§Ù„ØºØ¯Ø¯ Ø§Ù„ØµÙ…Ø§Ø¡ (Endocrinology) | 0.83   | 0.96   | 0.89     | 964     |

**Macro Avg** â†’ Precision: 0.87 | Recall: 0.87 | F1: 0.86  
**Weighted Avg** â†’ Precision: 0.87 | Recall: 0.87 | F1: 0.86  

---

## ğŸ” Confusion Matrix  

|               | Pred 0 | Pred 1 | Pred 2 | Pred 3 | Pred 4 |
|---------------|--------|--------|--------|--------|--------|
| **True 0**    | 920    | 25     | 15     | 20     | 23     |
| **True 1**    | 60     | 785    | 50     | 90     | 63     |
| **True 2**    | 22     | 30     | 697    | 45     | 16     |
| **True 3**    | 28     | 70     | 40     | 865    | 14     |
| **True 4**    | 12     | 18     | 5      | 35     | 894    |

âœ… Diagonal values = correct predictions  
âš ï¸ Off-diagonal values = misclassifications  


