# 🩺 Tashkhees  

![Python](https://img.shields.io/badge/Python-3.9%2B-blue?logo=python)  
![PyTorch](https://img.shields.io/badge/PyTorch-Framework-red?logo=pytorch)  
![Transformers](https://img.shields.io/badge/HuggingFace-Transformers-yellow?logo=huggingface)  
![MARBERT](https://img.shields.io/badge/Model-MARBERT-red)  
![LoRA](https://img.shields.io/badge/FineTuning-LoRA-green)  
![PEFT](https://img.shields.io/badge/PEFT-Enabled-purple)  
![CamelTools](https://img.shields.io/badge/CamelTools-Preprocessing-orange)  
![Gradio](https://img.shields.io/badge/UI-Gradio-orange?logo=gradio)  
![SpeechRecognition](https://img.shields.io/badge/Lib-SpeechRecognition-lightblue)  
![gTTS](https://img.shields.io/badge/Lib-gTTS-brightgreen)  
![Gemini](https://img.shields.io/badge/API-Gemini-lightblue)  

---

## 🚀 Overview  
**Tashkhees** is a professional **Arabic medical question classification** system.  

It integrates **deep learning + NLP preprocessing + API intelligence** in one pipeline:  
- 🧠 **Fine-tuned MARBERT (with LoRA & PEFT)** for domain-specific classification.  
- 🧹 **Scrubbing & advanced preprocessing**: normalization, diacritic removal, tokenization (via **CamelTools**).  
- 🎙️ **Speech-to-text** input with `SpeechRecognition` and **text-to-speech** feedback using `gTTS`.  
- 📊 **Threshold-based hybrid decision making**:  
  - High confidence → classification from fine-tuned model.  
  - Low confidence → fallback to **Gemini API**.  
- 💬 **Unified answers** always generated by Gemini, while **labels** come from the model or Gemini depending on confidence.  

---

## 📊 Dataset  
- **Source**: curated Arabic **medical Q&A website** → [Altibbi](https://altibbi.com/)  
- **Classes (5 categories)**:  
  - 🩸 مرض السكري (Diabetes)  
  - 🏥 جراحة عامة (General Surgery)  
  - 🦴 جراحة العظام (Orthopedics)  
  - 🌬️ أمراض الجهاز التنفسي (Respiratory)  
  - 🔬 الغدد الصماء (Endocrinology)  
- **Preprocessing**:  
  - Scrubbing (cleaning noisy text, removing HTML, symbols)  
  - Normalization (Alef, Teh Marbuta, Alef Maksura)  
  - Diacritic removal  
  - Tokenization (CamelTools)  

---

## 🧠 Model  
- **Base model**: [MARBERT](https://huggingface.co/UBC-NLP/MARBERT)  
- **Fine-tuning**: [LoRA](https://arxiv.org/abs/2106.09685) + [PEFT](https://huggingface.co/docs/peft/index)  
- **Frameworks**: Hugging Face Transformers, PyTorch  

---

## ⚙️ Features  
✅ End-to-end **speech + text pipeline**  
✅ Arabic-specific **scrubbing & preprocessing** (CamelTools)  
✅ Multi-class classification (**5 medical categories**)  
✅ Hybrid decision-making with **Gemini API** fallback  
✅ Interactive **Gradio** web interface  
✅ Deployable on **Hugging Face Spaces**  

---

## 🌐 Demo  
🔗 [Live Demo on Hugging Face Spaces](https://huggingface.co/spaces/rasha102004/Medical-Arabic-Speech-Classifier)  

---

## 📈 Results  

The fine-tuned **MARBERT + LoRA** model achieved strong performance across all 5 medical categories:  

- ✅ **Test Accuracy**: 86.6%  
- ✅ **Test F1 Score**: 86.4%  

📊 **Classification Report**  

| Class | Description              | Precision | Recall | F1-score | Support |
|-------|--------------------------|-----------|--------|----------|---------|
| 0     | مرض السكري (Diabetes)    | 0.92      | 0.92   | 0.92     | 1003    |
| 1     | جراحة عامة (General Surgery) | 0.90  | 0.75   | 0.82     | 1048    |
| 2     | جراحة العظام (Orthopedics) | 0.84      | 0.86   | 0.85     | 810     |
| 3     | أمراض الجهاز التنفسي (Respiratory) | 0.84 | 0.85 | 0.84 | 1017    |
| 4     | الغدد الصماء (Endocrinology) | 0.83   | 0.96   | 0.89     | 964     |

**Macro Avg** → Precision: 0.87 | Recall: 0.87 | F1: 0.86  
**Weighted Avg** → Precision: 0.87 | Recall: 0.87 | F1: 0.86  

---

## 🔎 Confusion Matrix  

|               | Pred 0 | Pred 1 | Pred 2 | Pred 3 | Pred 4 |
|---------------|--------|--------|--------|--------|--------|
| **True 0**    | 920    | 25     | 15     | 20     | 23     |
| **True 1**    | 60     | 785    | 50     | 90     | 63     |
| **True 2**    | 22     | 30     | 697    | 45     | 16     |
| **True 3**    | 28     | 70     | 40     | 865    | 14     |
| **True 4**    | 12     | 18     | 5      | 35     | 894    |

✅ Diagonal values = correct predictions  
⚠️ Off-diagonal values = misclassifications  


